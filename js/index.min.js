function handleExternalURLs(){if(device.platform.toUpperCase()==="ANDROID")$(document).on("click",'a[href^="http"]',function(n){var t=$(this).attr("href");navigator.app.loadUrl(t,{openExternal:!0});n.preventDefault()});else if(device.platform.toUpperCase()==="IOS")$(document).on("click",'a[href^="http"]',function(n){var t=$(this).attr("href");window.open(t,"_system");n.preventDefault()})}function function_offerlist(){createCalender()}function OpenCalender(){showCalender("full")}function CloseCalender(){showCalender("mini")}function showCalender(n){var i=$("#mob-calender-d1").find(".data-dates");if(n=="full")$(i).css("display","block");else{var t=new Date,r=t.getDate(),u=t.getMonth(),f=t.getYear(),e=t.getDay();$(i).each(function(n,t){var i=$(this).attr("data-date-start"),u=$(this).attr("data-date-end");i<=r&&u>=r?$(t).css("display","block"):$(t).css("display","none")})}}function createCalender(){var u=new Date,r,n,b,o;$("#offerlist-header h1").html(u.toDateString());var v=["S","M","T","W","T","F","S"],y=u.getDate(),f=u.getMonth(),e=u.getFullYear(),k=u.getDay(),t=!0,i=1;for($("#mob-calender-d1").html(""),n=0;n<7;n++)t&&(t=!1,r=$("#mob-calender-d1").append('<div class="mob-calender-w"><\/div>'),$(r).append('<div class="mob-calender-space">&nbsp;<\/div>')),n%7==6&&t==!1&&(t=!0),$(r).append('<div class="mob-calender-day">'+v[n%7]+"<\/div>");t=!0;var h=!1,p=new Date(e,f+1,1),w=p.getDay(),r=null;for(n=0;n<35;n++){if(b=new Date(e,f,1),o=new Date(e,f+1,1),o.setDate(o.getDate()-1),o.getDate()<i)break;var s=new Date(e,f,i),c=s.getDate(),l=s.getMonth(),a=s.getFullYear(),d=s.getDay();n+1>=w&&(h=!0);t&&(t=!1,$("#mob-calender-d1").append('<div   data-date-start="'+i+'" data-date-end="'+(i+7)+'" class="mob-calender-w data-dates"><\/div>'),r=$("#mob-calender-d1").find(".data-dates").last(),$(r).append('<div class="mob-calender-space">&nbsp;<\/div>'));n%7==6&&t==!1&&(t=!0);h?(y==i?$(r).append('<div data-date="'+a+"-"+(l+1)+"-"+c+'" class="mob-calender-day"><div class="mob-calender-day-text mob-calender-today">'+i+"<\/div><\/div>"):$(r).append('<div data-date="'+a+"-"+(l+1)+"-"+c+'" class="mob-calender-day"><div class="mob-calender-day-text">'+i+"<\/div><\/div>"),i++):$(r).append('<div class="mob-calender-day">&nbsp;<\/div>')}buildCalenderClick()}function buildCalenderClick(){$(".mob-calender-day").click(function(){$(".mob-calender").find(".mob-calender-day-text").removeClass("mob-calender-today");$(this).find(".mob-calender-day-text").addClass("mob-calender-today");v_dateFrom=parseDate($(this).attr("data-date"));v_dateTo=parseDate($(this).attr("data-date"))})}function GetStoreOfferList(){currentOfferId=null;var n={StartDate:v_dateFrom,EndDate:v_dateTo,lat:defaultLatLng.k,lng:defaultLatLng.D,categoryId:v_category_id,productId:v_product_id,retailerId:v_retailer_id,countryId:v_country_id,cityId:v_city_id};$.ajax({type:"POST",data:JSON.stringify(n),crossDomain:!0,dataType:"json",contentType:"application/json; charset=utf-8",url:serviceUrl+"/GetStoreOfferList",success:function(n,t,i){var f,u,r,e;for($("#lstOffer li").slice(1).remove(),$("#offer-tempate-item").css("display","none"),f=$.parseJSON($.parseJSON(i.responseText).d),u=0;u<f.length;u++)r=null,u==0?r=$("#offer-tempate-item"):(r=$("#offer-tempate-item").clone(),$(r).attr("id","offer-tempate-item-"+u)),bindValue(r,f[u]),u>0&&$("#lstOffer").append(r),e=$(r).css("display"),$(r).css("display","block");bindOfferMouseEvents()},error:function(n,t,i){alert("error : "+i)}})}function bindOfferMouseEvents(){$("#lstOffer li").click(function(){$("#lstOffer li").find(".offer-sales-img-container").show();$("#lstOffer li").find(".offer-sales-img-container-select").hide();$("#lstOffer li").removeClass("offer-select-back");$(this).find(".offer-sales-img-container").toggle();$(this).find(".offer-sales-img-container-select").toggle();$(this).toggleClass("offer-select-back");var n=$(this).attr("data-id"),t=$(this).attr("data-detail"),i=$(this).attr("data-image");currentOfferDetail={id:n,detail:t,image:i}});$("#lstOffer a").on("click",function(n){n.preventDefault();$.mobile.navigate($(this).attr("href"),{data:{detail:currentOfferDetail.detail,image:currentOfferDetail.image}})})}function bindValue(n,t){return $(n).attr("data-id",t.ID),$(n).attr("data-detail",t.DESC),$(n).attr("data-image",t.IMAGE_LINK),$(n).find(".offer-sales-detail").attr("data-detail",t.DESC),$(n).find(".offer-sales-detail").attr("data-image",t.IMAGE_LINK),$(n).find(".offer-data-organization").html(t.STORE_NAME),$(n).find(".offer-data-title").html(t.TITLE),$(n).find(".offer-data-address").html(t.STORE_ADDRESS),$(n).find(".offer-sales-text").html(t.PER_SALES+"%"),$(n).find(".offer-img-container").css("background-image","url('"+t.THUMP_URL+"')"),n}function log(){isLog==1&&window.console&&window.console.log&&console.log.apply(this,arguments)}function mapInitialize(){if(directionsService=new google.maps.DirectionsService,map==null){defaultLatLng==null&&(defaultLatLng=getDefaultLatLng());center=defaultLatLng;var n={zoom:13,center:defaultLatLng,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map-canvas"),n)}}function addMarker(n){marker=new google.maps.Marker({position:n,map:map});markersArray.push(marker)}function clearOverlays(){if(markersArray)for(i in markersArray)markersArray[i].setMap(null)}function showOverlays(){if(markersArray)for(i in markersArray)markersArray[i].setMap(map)}function deleteOverlays(){if(markersArray){for(i in markersArray)markersArray[i].setMap(null);markersArray.length=0}}function createMarker(n,t){var r='<div id="content"><div id="siteNotice"><\/div><h3 id="firstHeading" class="firstHeading">Store Info<\/h3><div id="bodyContent"><p><b>Address : <\/b>'+t+"<\/p><\/div><\/div>",i=new google.maps.Marker({position:n,map:map,title:"Store!"}),u=new google.maps.InfoWindow({content:r});google.maps.event.addListenerOnce(map,"idle",function(){google.maps.event.trigger(map,"resize");map.setCenter(center)});google.maps.event.addListener(i,"click",function(){u.open(map,i)});markersArray.push(i)}function getDefaultLatLng(){var n=new google.maps.LatLng(25.2040945,55.3152896);if(navigator.geolocation){function t(t){n=new google.maps.LatLng(t.coords.latitude,t.coords.longitude)}function i(){}navigator.geolocation.getCurrentPosition(t,i,{maximumAge:5e5,enableHighAccuracy:!0,timeout:6e3})}return n}function BindCalender(){$("#txtDateFrom").bind("change",function(n){n.stopImmediatePropagation();var t=$(this).val();v_dateFrom=parseDate(t)});$("#txtDateTo").bind("change",function(n){n.stopImmediatePropagation();var t=$(this).val();v_dateTo=parseDate(t)})}function parseDate(n){var t=n.split("-");return new Date(t[0],t[1]-1,t[2])}function buildClear(){$("#aClearAll").click(function(){ClearData("#lstCategory");ClearData("#lstProduct");ClearData("#lstRetailer");ClearData("#lstCountry");ClearData("#lstCity");$("#txtDateFrom").val("");$("#txtDateTo").val("");v_dateFrom=new Date(1990,0,1);v_dateTo=new Date(1990,0,1);v_category_id=-1;v_category_name=null;v_product_id=-1;v_product_name=null;v_retailer_id=-1;v_retailer_name=null;v_country_id=-1;v_country_name=null;v_city_id=-1;v_city_name=null})}function bindSearchData(){var n;if(v_category_id!=-1&&SetData("#lstCategory",v_category_id,v_category_name),v_product_id!=-1&&SetData("#lstProduct",v_product_id,v_product_name),v_retailer_id!=-1&&SetData("#lstRetailer",v_retailer_id,v_retailer_name),v_country_id!=-1&&SetData("#lstCountry",v_country_id,v_country_name),v_city_id!=-1&&SetData("#lstCity",v_city_id,v_city_name),n=new Date(1990,0,1),v_dateFrom!=n){var t=v_dateFrom.getDate(),i=v_dateFrom.getMonth(),r=v_dateFrom.getFullYear();$("#txtDateFrom").val(r+"-"+pad(i+1,2)+"-"+pad(t,2))}v_dateTo!=n&&$("#txtDateTo").val(v_dateTo)}function SetData(n,t,i){var u=$(n).prev("form"),r=$(u).find("input");$(r).attr("data-Id",t);$(r).val(i)}function ClearData(n){var i=$(n).prev("form"),t=$(i).find("input");$(t).attr("data-Id",-1);$(t).val("")}function BuildAutoCompile(n,t){$(n).on("filterablebeforefilter",function(n,i){var r=$(this),u=$(i.input),f=u.val(),e="",o,s;r.html("");f&&f.length>1&&(r.html("<li><div class='ui-loader'><span class='ui-icon ui-icon-loading'><\/span><\/div><\/li>"),r.listview("refresh"),o=u.val(),s={find:o},$.ajax({type:"POST",data:JSON.stringify(s),crossDomain:!0,dataType:"json",contentType:"application/json; charset=utf-8",url:t,success:function(){},error:function(n,t){alert("error : "+t)}}).then(function(n){var t=$.parseJSON(n.d);$.each(t,function(n,t){e+="<li data-id='"+t.Key+"' >"+t.Value+"<\/li>"});r.html(e);r.listview("refresh");r.trigger("updatelayout")}))});$(n).on("click","li",function(){SetData(n,$(this).attr("data-Id"),$(this).text());$(n).find("li").hide();n=="#lstCategory"?(v_category_id=parseInt($(this).attr("data-Id")),v_category_name=$(this).text()):n=="#lstProduct"?(v_product_id=parseInt($(this).attr("data-Id")),v_product_name=$(this).text()):n=="#lstRetailer"?(v_retailer_id=parseInt($(this).attr("data-Id")),v_retailer_name=$(this).text()):n=="#lstCountry"?(v_country_id=parseInt($(this).attr("data-Id")),v_country_name=$(this).text()):n=="#lstCity"&&(v_city_id=parseInt($(this).attr("data-Id")),v_city_name=$(this).text())})}function pad(n,t){return n=n.toString(),n.length<t?pad("0"+n,t):n}var app={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){app.receivedEvent("deviceready");window.device||(window.device={platform:"Browser"});handleExternalURLs()},receivedEvent:function(n){var t=document.getElementById(n),i=t.querySelector(".listening"),r=t.querySelector(".received");i.setAttribute("style","display:none;");r.setAttribute("style","display:block;");console.log("Received Event: "+n)}},v_dateFrom=new Date,v_dateTo=new Date,v_category_id=-1,v_product_id=-1,v_retailer_id=-1,v_country_id=-1,v_city_id=-1,v_category_name=null,v_product_name=null,v_retailer_name=null,v_country_name=null,v_city_name=null,currentOfferId=null,serviceUrl="http://localhost:2497/MobileOfferFinderService.asmx",currentOfferDetail=null;$(document).on("pageinit","#offerlist",function(){function_offerlist();try{mapInitialize()}catch(n){console.log("pageinit - Exception : "+n)}$("#ashowcal").click(function(){$(this).hasClass("ui-icon-day")==!0?(CloseCalender(),$(this).addClass("ui-icon-calendar"),$(this).removeClass("ui-icon-day")):(OpenCalender(),$(this).addClass("ui-icon-day"),$(this).removeClass("ui-icon-calendar"))});CloseCalender();$("#ashowcal").addClass("ui-icon-calendar");$("#ashowcal").removeClass("ui-icon-day")});$(document).on("pagebeforeshow","#offerlist",function(){GetStoreOfferList()});$(document).on("pagebeforehide","#offerlist",function(){});$(document).on("pagebeforeshow","#detail",function(){if(currentOfferDetail!=null){var n=currentOfferDetail.detail,t=currentOfferDetail.image;$("#detail").find("#details-main").css("background-image","url('"+t+"')");$("#detail").find("#detailContainer").html("<p>"+n+"<\/p>")}});$(document).on("pagebeforehide","#detail",function(){currentOfferDetail=null});var map=null,center,markersArray=[],isLog=1,defaultLatLng=null,directionsService=null;$(document).on("pagebeforehide","#map-page",function(){console.log("#map-page -> pagebeforehide -> success");try{clearOverlays();createMarker(center,"XXXXX");createMarker(new google.maps.LatLng(29.313191,48.006735),"YYYY")}catch(n){console.log("pagebeforehide - Exception : "+n)}});$(document).on("pagebeforeshow","#map-page",function(){if(currentOfferDetail!=null){var n={offerId:currentOfferDetail.id};$.ajax({type:"POST",data:JSON.stringify(n),crossDomain:!0,dataType:"json",contentType:"application/json; charset=utf-8",url:serviceUrl+"/GetStore",success:function(n,t,i){var r=$.parseJSON($.parseJSON(i.responseText).d),u,f,e;defaultLatLng=new google.maps.LatLng(r.LATITUDE,r.LONGTIUDE);center=defaultLatLng;map.setCenter(defaultLatLng);u={origin:getDefaultLatLng(),destination:defaultLatLng,travelMode:google.maps.DirectionsTravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC};f={markers:[{latitude:r.LATITUDE,longitude:r.LONGTIUDE,title:r.NAME,content:r.ADDRESS1+","+r.ADDRESS2+","+r.ADDRESS3}]};try{$.each(f.markers,function(n,t){createMarker(new google.maps.LatLng(t.latitude,t.longitude),t.content)});e=new google.maps.Marker({position:getDefaultLatLng(),map:map,title:"You"});markersArray.push(e);directionsService.route(u,function(n,t){t==google.maps.DirectionsStatus.OK?new google.maps.DirectionsRenderer({map:map,directions:n}):alert("Unable to retrieve your route<br />")})}catch(o){console.log("pagebeforeshow - Exception : "+o)}},error:function(n,t){alert("error : "+t)}});console.log("#map-page -> pagebeforeshow -> success")}});$(document).on("pageinit","#map-page",function(){console.log("#map-page -> pageinit -> success");try{mapInitialize()}catch(n){console.log("pageinit - Exception : "+n)}console.log("#map-page -> pageinit - END")});$(document).on("mobileinit",function(){$.support.cors=!0;$.mobile.allowCrossDomainPages=!0;$.mobile.phonegapNavigationEnabled=!0});app.initialize();$(document).on("pagebeforeshow","#search",function(){bindSearchData()});$(document).on("pagebeforehide","#search",function(){});$(document).on("pageinit","#search",function(){buildClear();BindCalender();BuildAutoCompile("#lstCategory",serviceUrl+"/GetCategory");BuildAutoCompile("#lstProduct",serviceUrl+"/GetProduct");BuildAutoCompile("#lstRetailer",serviceUrl+"/GetRetailer");BuildAutoCompile("#lstCountry",serviceUrl+"/GetCountry");BuildAutoCompile("#lstCity",serviceUrl+"/GetCity")});
/*
//# sourceMappingURL=index.min.js.map
*/